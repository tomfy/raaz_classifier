This is perl code to implement a way of calculating 'histograms' similar to Sainudiin et al.
We run a markov chain over partitions of the space {0,1}^p. Our data is a set of N points (not necessarily distinct) points from that space, e.g. for p = 5, x = (0,1,1,0,0) would be a possible point. The partitions are generated by splitting the space in half into two boxes (by putting all the data points with x_1 = 0 in one box, and x_1 = 1 in the other. Then either or both of these boxes can be further split by considering x_2. Etc. The partition is represented as a binary, planar tree; i.e. each node has either no child nodes (it is a leaf), or 2 child nodes, a left node (with the x_j = 0 points) and a right node (with the x_j = 1 points).
